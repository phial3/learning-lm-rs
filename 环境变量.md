Cargo 提供的内置环境变量及其获取方式

主要有以下几类环境变量：

1. Cargo 内置环境变量：
```rust
// 常用的 Cargo 环境变量
env!("CARGO_MANIFEST_DIR")      // 项目根目录路径
env!("CARGO_PKG_VERSION")       // 当前包版本
env!("CARGO_PKG_AUTHORS")       // 包作者
env!("CARGO_PKG_NAME")          // 包名
env!("CARGO_PKG_DESCRIPTION")   // 包描述
```

2. 获取环境变量的几种方式：
```rust
// 1. 编译时获取(如果变量不存在会编译错误)
let dir = env!("CARGO_MANIFEST_DIR");

// 2. 编译时获取(可提供默认值)
let key = option_env!("SOME_KEY").unwrap_or("default value");

// 3. 运行时获取
use std::env;
let key = env::var("SOME_KEY").unwrap_or_default();
```

这些环境变量的文档可以在以下地方查找：

1. Cargo 官方文档：
    - https://doc.rust-lang.org/cargo/reference/environment-variables.html

2. Cargo 内置环境变量列表：
    - https://doc.rust-lang.org/cargo/reference/environment-variables.html#environment-variables-cargo-sets-for-crates

3. 常见环境变量分类：

```rust
// 构建相关
CARGO_MANIFEST_DIR    // 当前包的 manifest 文件目录
CARGO_TARGET_DIR      // 构建产物输出目录
CARGO_HOME            // Cargo 主目录

// 包信息
CARGO_PKG_VERSION    // 包版本
CARGO_PKG_AUTHORS    // 包作者
CARGO_PKG_NAME       // 包名
CARGO_PKG_DESCRIPTION // 包描述
CARGO_PKG_HOMEPAGE   // 包主页
CARGO_PKG_REPOSITORY // 代码仓库
CARGO_PKG_LICENSE    // 许可证

// 目标平台
TARGET               // 目标三元组(例如 x86_64-unknown-linux-gnu)
HOST                 // 主机平台三元组
RUSTC                // rustc 编译器路径
RUSTDOC              // rustdoc 文档工具路径

// 特性标记
CARGO_FEATURE_<name> // 启用的特性标记
CARGO_CFG_<cfg>      // 配置标记
```

4. 在代码中检查环境变量定义：
```rust
// 检查环境变量是否定义
#[cfg(debug_assertions)]
const DEBUG: bool = true;

// 条件编译
#[cfg(target_os = "windows")]
fn windows_only() {
    // Windows 特定代码
}
```

一些实用技巧：

1. 在开发时打印环境变量：
```rust
fn main() {
    println!("CARGO_MANIFEST_DIR: {}", env!("CARGO_MANIFEST_DIR"));
    println!("CARGO_PKG_VERSION: {}", env!("CARGO_PKG_VERSION"));
    
    // 打印所有环境变量
    for (key, value) in std::env::vars() {
        println!("{}: {}", key, value);
    }
}
```

2. 在构建脚本(build.rs)中使用：
```rust
// build.rs
fn main() {
    // 获取目标架构
    let target = std::env::var("TARGET").unwrap();
    
    // 根据不同平台执行不同操作
    if target.contains("windows") {
        // Windows 特定构建步骤
    }
}
```

3. 在测试中使用：
```rust
#[test]
fn test_env_vars() {
    assert_eq!(env!("CARGO_PKG_NAME"), "your_package_name");
    
    // 运行时环境变量
    if let Ok(path) = std::env::var("PATH") {
        println!("PATH: {}", path);
    }
}
```

总结：
- `env!` 宏用于编译时获取环境变量
- `option_env!` 提供了一个可选的默认值
- `std::env::var` 用于运行时获取环境变量
- Cargo 提供了大量有用的内置环境变量
- 环境变量在构建脚本、测试和条件编译中都很有用
- 官方文档是了解所有可用环境变量的最佳资源